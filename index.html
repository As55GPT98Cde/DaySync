<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>DaySync</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3367D6">
  <style>
    body { margin:0; font-family: -apple-system, BlinkMacSystemFont, sans-serif; color:#333; }
    .container { display:flex; flex-direction:column; min-height:100vh; padding:1rem; box-sizing:border-box; }
    .field { display:flex; justify-content:space-between; align-items:center; margin:0.5rem 0; }
    label { font-size:1rem; flex:1; }
    input[type=time] { font-size:1rem; width:6rem; text-align:right; }
    .header { text-align:center; margin-bottom:1rem; }
    .header h1 { font-size:1.5rem; margin:0; }
    .header p { font-size:0.9rem; margin:0.2rem 0 1rem; color:#666; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>DaySync</h1>
      <p>Enter any time to recalculate your day</p>
    </div>
    <div id="fields"></div>
  </div>
  <script>
    const events = [
      { name: 'Wake Up', duration:30, buffer:0 },
      { name: 'Morning Walk', duration:30, buffer:0 },
      { name: 'Decompression', duration:20, buffer:10 },
      { name: 'Corrective', duration:10, buffer:0 },
      { name: 'Workout', duration:30, buffer:5 },
      { name: 'Smoothie & Shower', duration:30, buffer:5 },
      { name: 'Leave for Coffee', duration:25, buffer:10 },
      { name: 'Work Block 1', duration:60, buffer:5 },
      { name: 'Work Block 2', duration:60, buffer:5 },
      { name: 'Work Block 3', duration:60, buffer:5 },
      { name: 'Work Block 4', duration:60, buffer:5 },
      { name: 'Personal Start', duration:60, buffer:5 },
      { name: 'Leave for Dinner', duration:30, buffer:20 },
      { name: 'Dinner', duration:60, buffer:0 },
      { name: 'Evening Walk', duration:30, buffer:0 },
      { name: 'Free Time', duration:150, buffer:0 },
      { name: 'Shower', duration:30, buffer:0 },
      { name: 'Meditation', duration:30, buffer:0 },
      { name: 'In Bed', duration:30, buffer:0 },
      { name: 'Sleep By', duration:0, buffer:0 }
    ];

    const container = document.getElementById('fields');
    let times = [];

    function minutesToHHMM(m) {
      m = (m + 24*60) % (24*60);
      const hh = String(Math.floor(m/60)).padStart(2,'0');
      const mm = String(m%60).padStart(2,'0');
      return `${hh}:${mm}`;
    }

    function recalc(startIdx=0) {
      for (let i = startIdx + 1; i < events.length; i++) {
        const prev = events[i-1];
        times[i] = times[i-1] + prev.duration + events[i].buffer;
        inputs[i].value = minutesToHHMM(times[i]);
      }
    }

    const inputs = events.map((evt, i) => {
      const field = document.createElement('div'); field.className = 'field';
      const label = document.createElement('label'); label.textContent = evt.name;
      const input = document.createElement('input'); input.type = 'time'; input.step = 60;
      field.append(label, input);
      container.appendChild(field);

      input.addEventListener('change', () => {
        const [h,m] = input.value.split(':').map(Number);
        times[i] = h*60 + m;
        recalc(i);
      });
      return input;
    });

    times[0] = 7*60;
    inputs[0].value = minutesToHHMM(times[0]);
    times[1] = times[0] + events[0].duration + events[1].buffer;
    inputs[1].value = minutesToHHMM(times[1]);
    recalc(1);
  </script>
</body>
</html>
